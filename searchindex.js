Search.setIndex({"docnames": ["dataset_and_deepdive", "gnn_ground_up", "gnn_to_transformers", "graph_basics", "guide", "index", "lumi", "notebooks/session_1/1a_representing_graphs_for_neural_networks", "notebooks/session_1/1a_representing_graphs_for_neural_networks_solutions", "notebooks/session_1/1b_vector_sums_vs_concatenation", "notebooks/session_2/2a_full_training_pipeline", "notebooks/session_3/3a_Graph_Neural_Network_Encoder_solutions", "notebooks/session_4/4a_GNNs_to_Transformers", "notebooks_and_colab", "presentations", "quick-reference"], "filenames": ["dataset_and_deepdive.rst", "gnn_ground_up.rst", "gnn_to_transformers.rst", "graph_basics.rst", "guide.rst", "index.rst", "lumi.rst", "notebooks/session_1/1a_representing_graphs_for_neural_networks.ipynb", "notebooks/session_1/1a_representing_graphs_for_neural_networks_solutions.ipynb", "notebooks/session_1/1b_vector_sums_vs_concatenation.ipynb", "notebooks/session_2/2a_full_training_pipeline.ipynb", "notebooks/session_3/3a_Graph_Neural_Network_Encoder_solutions.ipynb", "notebooks/session_4/4a_GNNs_to_Transformers.ipynb", "notebooks_and_colab.rst", "presentations.rst", "quick-reference.rst"], "titles": ["From molecules to PyTorch Tensors", "Graph Neural Networks from the ground up", "GNNs to Transformers", "Graph Basics", "Instructor\u2019s guide", "Graph Neural Networks and Transformer workshop", "Running the material on the LUMI super computer", "Representing graphs for neural networks", "Representing graphs for neural networks", "Summing or concatenating embeddings?", "Datasets, Dataloaders and Training", "Implementing a Graph Neural Network", "GNNs to Transformers", "Notebooks and Colab", "Presentations", "Quick Reference"], "terms": {"In": [0, 1, 2, 3, 5, 6, 8, 9, 10, 12], "thi": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 13], "lesson": [0, 1, 2, 3, 12], "we": [0, 1, 2, 3, 5, 6, 8, 9, 10, 12, 13, 15], "look": [0, 3, 5, 8, 9, 11, 12], "how": [0, 1, 2, 3, 5, 6, 8, 9, 10, 12], "go": [0, 1, 3, 5, 6, 7, 8, 10, 12], "graph": [0, 2, 15], "repres": [0, 2, 3, 5, 9, 10, 11], "problem": [0, 5, 10, 11, 12], "all": [0, 5, 6, 7, 8, 9, 10, 11, 12], "wai": [0, 5, 7, 8, 9, 10, 12], "ll": [0, 2, 3, 7, 8, 9, 10, 11, 12], "focu": [0, 5, 10, 12], "creat": [0, 3, 5, 6, 9, 10, 11, 12], "dataset": [0, 5, 12], "pack": [0, 11], "multitpl": 0, "minibatch": [0, 10], "us": [0, 1, 3, 5, 6, 10, 12, 13, 15], "molecular": [0, 10], "practic": [0, 3, 5, 7, 8, 9, 10, 11, 12], "exampl": [0, 6, 8, 9, 10, 12], "sinc": [0, 7, 8, 9, 10, 11, 12, 13], "thei": [0, 5, 7, 8, 9, 10, 11, 12], "ar": [0, 3, 5, 6, 8, 9, 10, 11, 12, 15], "intuit": [0, 9], "allow": [0, 7, 8, 9, 10, 11, 12], "u": [0, 7, 8, 9, 10, 11, 12], "work": [0, 1, 5, 7, 8, 9, 10, 11, 12, 13], "real": [0, 7, 8, 10], "data": [0, 2, 5, 8, 9, 12], "predict": [0, 1, 2, 11, 12], "task": [0, 9], "The": [0, 5, 6, 9, 13, 14], "end": [0, 7, 8, 9, 11, 12, 14], "try": [0, 8, 9, 10, 11], "out": [0, 5, 6, 7, 8, 9, 10, 11, 12], "neural": [0, 3, 9, 12], "network": [0, 3, 9, 12], "without": [0, 7, 8, 10, 11], "detail": [0, 1, 3, 5, 10, 11], "architectur": [0, 5, 10, 11, 12], "gnn": [0, 1, 5, 10, 15], "overview": 0, "dataload": [0, 5, 11, 12], "option": [0, 1, 3, 7, 8], "scaffold": [0, 10, 11, 12], "split": [0, 11, 12], "implement": [1, 2, 5, 8], "cover": [1, 5, 10, 11, 12], "fundament": [1, 5, 12], "idea": [1, 2, 5, 7, 8, 9, 10, 11, 12], "messag": [1, 2, 6, 12], "pass": [1, 2, 10, 12], "pytorch": [1, 2, 5, 7, 8, 10, 11, 12], "spend": 1, "much": [1, 7, 8, 9, 12], "time": [1, 6, 7, 8, 10, 11, 12], "directli": [1, 7, 8, 11, 12], "tensor": [1, 2, 9, 10, 11, 12], "One": [1, 8, 9, 10, 11], "techniqu": 1, "which": [1, 5, 6, 8, 9, 10, 11, 12, 13], "often": [1, 7, 8, 9, 10, 11, 12], "i": [1, 6, 8, 10, 11, 13], "_broadcasting_": [1, 11], "one": [1, 3, 6, 9, 10, 11, 12], "over": [1, 7, 8, 9, 10, 11, 12], "anoth": [1, 2, 6, 7, 8, 9, 10, 11], "guid": [1, 6], "explain": [1, 5, 7, 8, 10], "concept": [1, 7, 8, 11], "build": [1, 7, 8, 11, 12], "block": [1, 5, 8, 10, 11, 12], "solut": 1, "full": [1, 10, 11, 12], "incomplet": 1, "head": [1, 2, 11], "up": [2, 6, 9, 10, 12], "till": [2, 12], "now": [2, 6, 7, 8, 9, 10, 11, 12], "ve": [2, 7, 8, 9, 10, 11, 12], "familiar": [2, 5, 7, 8, 12], "ourselv": [2, 7, 8, 11], "convolut": [2, 9, 12], "take": [2, 5, 8, 9, 10, 12, 13], "step": [2, 6, 7, 8, 10], "show": [2, 5, 8, 9, 10, 11], "can": [2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 14], "gener": [2, 5, 7, 8, 9, 10, 11, 12], "_learn_": 2, "induc": [2, 12], "structur": [2, 5, 10, 11, 13], "from": [2, 5, 6, 9, 10, 14], "ani": [2, 5, 7, 8, 9, 10, 11, 12, 13], "set": [2, 5, 6, 8, 9, 11, 12], "first": [3, 6, 7, 8, 9, 10, 11, 12, 13], "what": [3, 6, 8, 9, 11], "them": [3, 5, 6, 7, 8, 9, 10, 11, 12], "plain": 3, "python": [3, 10, 11, 13], "also": [3, 6, 7, 8, 9, 10, 11, 12, 14], "differ": [3, 5, 6, 8, 9, 10, 11, 12], "variabl": [3, 6, 9, 10, 12], "type": [3, 7, 8, 10, 11, 12], "typic": [3, 7, 8, 9, 10, 11, 12, 13], "encount": [3, 9], "continu": [3, 12], "categor": [3, 7, 8, 9, 11, 12], "For": [3, 8, 9, 10, 11, 12], "well": [3, 5, 6, 7, 8, 9, 10, 11, 12], "embed": [3, 5, 10, 12], "layer": [3, 7, 8, 9, 10, 12], "dens": [3, 7, 8, 10, 11, 12], "vector": [3, 5, 7, 10, 12], "combin": [3, 9, 10, 12], "multipl": [3, 5, 9, 10, 11, 12], "singl": [3, 7, 8, 9, 10, 11, 12], "featur": 3, "sum": [3, 5, 7, 8, 10, 11, 12], "v": [3, 8, 9, 11, 12], "concaten": [3, 5, 7, 8, 11, 12], "code": [3, 11], "don": [3, 7, 8, 9, 10, 12], "t": [3, 5, 7, 8, 10, 12], "hot": [3, 7, 9], "quickli": 5, "gain": 5, "popular": 5, "due": [5, 10, 11, 12], "mani": [5, 7, 8, 9, 10, 11, 12], "easili": [5, 6, 9, 10, 11, 12], "model": [5, 7, 8, 9, 11, 12], "deep": [5, 8, 10, 11, 12], "dive": [5, 7, 8, 10, 11, 12], "you": [5, 6, 8, 10, 11, 12, 13, 14], "solv": [5, 10, 11], "complex": [5, 10, 12, 13], "where": [5, 7, 8, 9, 11, 12], "input": [5, 7, 8, 9, 10, 12], "domain": [5, 10, 12], "size": [5, 7, 8, 9, 10, 12], "assum": [5, 6, 7, 8, 9, 10, 11, 12], "learn": [5, 7, 8, 9, 11], "attend": [5, 12], "should": [5, 6, 7, 8, 9, 10, 11, 12, 13], "have": [5, 6, 7, 8, 9, 10, 11, 12], "befor": [5, 7, 8, 9, 11, 12, 13], "It": [5, 6, 7, 8, 9, 10, 11, 12], "basic": [5, 7, 8, 10, 11, 12], "understand": [5, 11], "linear": [5, 10, 11, 12], "algebra": 5, "experi": [5, 7, 8, 9, 12], "make": [5, 7, 8, 9, 10, 11, 12, 13], "easier": [5, 10, 11, 13], "through": [5, 6, 7, 8, 10, 11, 12], "consid": [5, 7, 8, 9, 11], "prerequsit": 5, "divid": [5, 11, 12], "four": [5, 10, 14], "each": [5, 8, 9, 10, 11, 12, 13, 14], "correspond": [5, 7, 8, 11, 12], "roughli": 5, "hour": [5, 10], "design": 5, "googl": [5, 8, 10, 11, 12, 13], "find": [5, 8, 10, 11, 12, 14], "link": 5, "onlin": [5, 9], "offlin": 5, "version": [5, 6, 9, 11, 12], "maintain": 5, "here": [5, 7, 8, 9, 10, 11, 12, 14, 15], "train": [5, 9], "quick": 5, "instructor": 5, "": [5, 6, 7, 8, 9, 10, 11, 12], "run": [5, 7, 8, 10], "lumi": 5, "super": [5, 10, 11, 12], "comput": [5, 8, 9, 10, 11], "aim": 5, "student": 5, "research": [5, 12], "engin": 5, "programm": 5, "alreadi": [5, 7, 8, 11, 12], "want": [5, 8, 9, 10, 11, 12], "choic": [5, 9, 10, 11, 12], "involv": 5, "doe": [5, 8, 10, 11], "divers": 5, "framework": [5, 7, 8, 9, 12], "particip": 5, "program": [5, 6, 7, 8], "simpl": [5, 7, 8, 9, 10, 12], "arithmet": 5, "machin": [5, 6, 8], "procedur": [5, 9, 12], "issu": [5, 8, 9, 11], "develop": [5, 10, 12, 13], "eurocc": 5, "nation": 5, "compet": 5, "center": [5, 9, 11, 12], "sweden": 5, "encc": 5, "institut": 5, "licens": 5, "under": [5, 10], "cc": [5, 12], "BY": 5, "sa": 5, "0": [5, 7, 8, 9, 10, 11, 12], "reus": 5, "form": [5, 7, 8, 9, 12], "appropri": [5, 9], "other": [5, 7, 8, 9, 10, 11, 12], "wish": [5, 12], "teach": 5, "advic": 5, "base": [5, 7, 8, 9, 10, 11, 12], "jupyt": [5, 13], "colaboratori": [5, 13], "notebok": 5, "start": [5, 7, 8, 10, 11, 12, 13], "your": [5, 6, 7, 8, 9, 11, 13], "own": [5, 12, 13], "copi": [5, 7, 8, 10, 12, 13], "file": [5, 6], "save": [5, 10, 11, 12, 13], "drive": [5, 13], "chang": [5, 6, 10, 11, 12, 13], "remain": [5, 11, 12], "otherwis": [5, 11, 13], "lost": 5, "when": [5, 8, 10, 11, 12], "close": [5, 11], "window": 5, "There": [5, 7, 8, 9, 10, 11, 12], "grow": 5, "number": [5, 8, 9, 10, 11, 12, 13], "resours": 5, "good": [5, 9, 10, 11, 12], "place": [5, 8, 10, 11, 12], "stanford": 5, "cs224w": 5, "manner": [5, 9], "statist": [5, 10], "topic": 5, "theori": 5, "lectur": [5, 11], "exercis": 5, "previou": [5, 10, 11, 14], "offer": [5, 14], "avail": 5, "geometr": [5, 10, 12], "erlangen": 5, "ml": 5, "bronstein": 5, "et": [5, 10, 12], "al": [5, 10, 11, 12], "unifi": 5, "perspect": [5, 10], "encapsul": [5, 7, 8, 10, 11], "veri": [5, 7, 8, 9, 10, 11, 12], "treatment": 5, "excel": 5, "invit": 5, "talk": [5, 12], "iclr": 5, "2021": 5, "lai": [5, 9], "pre": [5, 8, 10, 11, 12], "print": [5, 7, 8, 10, 11, 12], "book": 5, "grid": [5, 11], "group": [5, 7], "geodes": 5, "gaug": 5, "expand": 5, "A": [5, 7, 8, 9, 10, 11, 14], "seri": [5, 11], "video": [5, 11], "depth": [5, 11], "becom": [5, 11, 12], "de": 5, "facto": 5, "packag": [5, 11, 13], "doesn": [5, 10, 11, 12], "support": [5, 8, 10, 11, 12], "approach": [5, 10], "regular": [5, 12], "high": [5, 7, 8], "level": [5, 7, 8], "effici": [5, 8, 9, 10, 11], "kernel": [5, 10, 11, 13], "spars": [5, 7, 8, 10, 11, 12], "brows": 5, "layout": [5, 9], "inspir": [5, 11], "deriv": 5, "coderefineri": 5, "mit": 5, "adapt": [5, 11], "most": [5, 7, 8, 9, 10, 11, 12, 13], "text": [5, 8, 9, 11, 12], "need": [6, 7, 8, 9, 10, 11, 12], "user": [6, 8, 10], "account": [6, 10, 11, 12], "abl": [6, 7, 8, 10, 11, 12], "connect": [6, 7, 8, 9, 10, 11, 12], "ssh": 6, "login": 6, "node": [6, 11, 12], "left": 6, "pair": [6, 7, 8, 10, 11, 12], "kei": [6, 7, 8, 10, 11, 12], "later": [6, 7, 8, 10, 11, 12], "onc": [6, 10, 11, 12, 13], "log": [6, 8], "home": [6, 7, 8], "directori": 6, "To": [6, 7, 8, 10, 11, 12], "handl": [6, 7, 8, 10, 11, 12], "git": 6, "track": [6, 7, 8, 10, 11], "your_usernam": 6, "uan01": 6, "clone": 6, "project": [6, 9, 11], "project_465000485": 6, "gnn_transformers_workshop": 6, "gnn_transformers_notebook": 6, "new": [6, 10, 11, 12], "call": [6, 7, 8, 10, 11, 12], "repositori": 6, "refer": [6, 7, 8, 11], "folder": 6, "updat": [6, 11, 12], "latest": 6, "c": [6, 7, 8, 9, 10, 11, 12], "pull": 6, "batch": [6, 8, 10, 12], "job": 6, "sh": 6, "do": [6, 8, 9, 10, 12, 13], "coupl": [6, 10], "thing": [6, 7, 8, 9, 10, 11, 12], "submit": 6, "script": 6, "locat": [6, 10, 11, 12], "slurm": 6, "resourc": 6, "manag": [6, 13], "system": [6, 10], "fail": 6, "pleas": 6, "perform": [6, 7, 8, 9, 10, 11, 12], "abov": [6, 8, 9, 10, 11, 12], "monitor": 6, "output": [6, 9, 10, 11, 12], "name": [6, 7, 8, 10, 11, 12], "someth": [6, 9, 11, 12], "like": [6, 8, 9, 10, 11, 12], "slurm_jobid": 6, "tail": 6, "eventu": [6, 11, 12], "ha": [6, 7, 8, 9, 10, 11, 12, 13, 14], "get": [6, 7, 8, 9, 10, 11, 12], "some": [6, 7, 8, 9, 10, 11, 12], "below": [6, 8, 9, 10, 11, 12, 14], "import": [6, 7, 8, 9, 10, 11], "section": [6, 7, 8, 11, 12, 13], "highlight": [6, 8, 11], "local": [6, 12], "forward": [6, 7, 8, 10, 11, 12], "linux": 6, "maco": 6, "mobaxterm": 6, "cmder": 6, "n": [6, 7, 8, 9, 10, 11, 12], "l": [6, 10, 11, 12], "8888": 6, "nid005517": 6, "nmn": 6, "csc": 6, "fi": 6, "putti": 6, "sourc": [6, 9], "destin": 6, "tunnel": 6, "past": 6, "url": 6, "browser": 6, "http": [6, 10, 11], "localhost": 6, "token": [6, 12], "36ffa17d87a728f3e4611234e6957afafc35e6ae30f63d82": 6, "These": [6, 7, 8, 10, 11, 12], "instruct": 6, "follow": [6, 8, 10, 11, 12, 13], "hostnam": 6, "likelihood": 6, "see": [6, 7, 8, 9, 10, 11, 12], "displai": 6, "safe": 6, "exit": 6, "ctr": 6, "export": 6, "id": [6, 8, 10], "environment": 6, "job_id": 6, "so": [6, 7, 8, 9, 10, 11, 12], "cancel": 6, "just": [6, 7, 8, 9, 10, 11, 12], "note": [6, 7, 8, 10, 11], "tell": [6, 7, 8, 9, 10, 11], "lumi_ed25519": 6, "command": 6, "your_own_machin": 6, "port": 6, "listen": 6, "b": [6, 7, 8, 10, 11, 12], "open": 6, "dure": [6, 10], "act": [6, 7, 8], "between": [6, 7, 8, 9, 10, 11, 12, 13], "If": [6, 7, 8, 9, 10, 11, 12], "an": [6, 9, 10, 11, 12, 14], "error": [6, 7, 8, 10, 11, 12], "unavail": 6, "case": [6, 7, 8, 9, 10, 11, 12], "e": [6, 8, 9, 10, 11, 12], "g": [6, 7, 8, 9, 10, 11, 12], "8900": 6, "onli": [6, 8, 9, 10, 11, 12], "point": [6, 8, 10, 11], "host": 6, "greet": 6, "list": [6, 8, 12], "suitabl": [7, 8], "differencc": [7, 8], "Then": [7, 8, 9], "discuss": [7, 8], "kind": [7, 8, 9, 10, 11, 12], "mean": [7, 8, 9, 10, 11, 12], "mark": [7, 8], "defin": [7, 8, 11, 12], "assign": [7, 8, 10, 11], "index": [7, 8, 9, 10, 11, 12], "therefor": [7, 8, 10, 11, 12], "explicitli": [7, 8, 9, 11, 12], "common": [7, 8, 9, 10, 11], "alwai": [7, 8, 11], "both": [7, 8, 9, 11, 12], "while": [7, 8, 10, 11, 12], "might": [7, 8, 9, 10, 11, 12], "seem": [7, 8], "wast": [7, 8], "algorithm": [7, 8, 9, 12], "applic": [7, 8, 11, 12], "modif": [7, 8], "4": [7, 8, 9, 10, 12, 14], "5": [7, 8, 9, 12, 13], "6": [7, 8], "7": [7, 8, 9], "datatyp": [7, 8, 10], "len": [7, 8, 9, 10, 11, 12], "x": [7, 8, 9, 10, 11, 12], "min": [7, 8], "relationship": [7, 8, 12], "wa": [7, 8, 9, 10, 11], "symmetr": [7, 8], "impli": [7, 8], "world": [7, 8], "social": [7, 8], "same": [7, 8, 9, 10, 11, 12], "properti": [7, 8, 10], "still": [7, 8, 9, 10, 12], "exact": [7, 8, 9], "def": [7, 8, 9, 10, 11, 12], "compare_graph": [7, 8], "nodes_1": [7, 8], "edges_1": [7, 8], "nodes_2": [7, 8], "edges_2": [7, 8], "return": [7, 8, 9, 11, 12], "8": [7, 8, 9, 10, 11, 12], "nodes_3": [7, 8], "edges_3": [7, 8], "nodes_4": [7, 8], "edges_4": [7, 8], "essenti": [7, 8, 9, 10, 11, 12], "pairwis": [7, 8], "element": [7, 8, 11, 12], "a_": [7, 8, 11, 12], "j": [7, 8, 9, 11, 12], "relationshop": [7, 8], "posit": [7, 8, 9, 10, 11, 12], "adjec": [7, 8, 12], "plai": [7, 8, 12], "central": [7, 8, 10], "role": [7, 8, 12], "transform": [7, 8, 10, 11], "begin": [7, 8, 9, 11, 12], "bmatrix": [7, 8, 9, 11, 12], "edit": [7, 8], "edge_set": [7, 8], "adjacency_matrix": [7, 8, 10, 11, 12], "working_matrix": [7, 8], "rang": [7, 8, 9, 10, 11, 12], "reli": [7, 8, 9, 10, 11, 12], "label": [7, 8, 9, 10, 11, 12], "indic": [7, 8, 9, 10, 11, 12], "some_code_her": [7, 8], "correct": [7, 8, 10, 11], "particular": [7, 8, 9, 10, 11, 12], "give": [7, 8, 10, 11, 12], "inform": [7, 8, 9, 10, 11], "about": [7, 8, 9, 10, 11], "color": [7, 8, 10], "weight": [7, 8, 9, 10, 11, 12], "formula": [7, 8], "atom": [7, 8, 10, 11, 12], "bond": [7, 8, 10, 11, 12], "associ": [7, 8, 9], "colour": [7, 8], "symbol": [7, 8], "d": [7, 8, 9, 10, 11, 12], "doubl": [7, 8, 10, 11, 12], "aromat": [7, 8, 10, 11, 12], "simpli": [7, 8, 11, 12], "caffein_nod": [7, 8], "atom_typ": [7, 8], "o": [7, 8, 10, 11, 12], "9": [7, 8], "10": [7, 8, 9, 10, 13], "11": [7, 8, 9, 10, 11, 12], "12": [7, 8, 9, 11], "13": [7, 8], "14": [7, 8], "frozenset": [7, 8, 10, 11, 12], "immut": [7, 8], "caffeine_edg": [7, 8], "care": [7, 8, 11], "express": [7, 8, 9, 11], "bond_typ": [7, 8, 10, 11, 12], "challenge_nod": [7, 8], "challenge_edg": [7, 8], "review_nod": [7, 8], "review_edg": [7, 8], "town_nod": [7, 8], "town_edg": [7, 8], "straight": [7, 8], "everyth": [7, 8], "dimension": [7, 8, 10, 12], "arrai": [7, 8, 9, 10, 11, 12], "seen": [7, 8, 9, 11, 12], "readili": [7, 8], "format": [7, 8], "suit": [7, 8, 10], "two": [7, 8, 9, 10, 11, 12, 14], "main": [7, 8, 11, 12], "separ": [7, 8, 9, 10, 11, 12], "numer": [7, 8, 9], "neg": [7, 8, 10, 12], "infin": [7, 8, 12], "perhap": [7, 8], "standard": [7, 8, 9, 12], "finit": [7, 8], "saw": [7, 8, 12], "rate": [7, 8, 10], "etc": [7, 8], "treat": [7, 8, 9, 11, 12], "special": [7, 8, 9, 11, 12], "ordin": [7, 8], "inequ": [7, 8], "dimens": [7, 8, 10, 11, 12], "100": [7, 8, 9], "its": [7, 8, 10, 11, 12], "distinct": [7, 8, 9], "almost": [7, 8, 10, 11], "paramet": [7, 8, 9, 10, 11, 12], "part": [7, 8, 9, 10, 11, 12], "requir": [7, 8, 9], "know": [7, 8, 10, 11, 12], "beforehand": [7, 8], "map": [7, 8, 10], "sym_caffeine_nod": [7, 8], "enc_caffeine_nod": [7, 8], "node_idx": [7, 8, 10, 11, 12], "node_attribut": [7, 8], "item": [7, 8, 9, 10, 11, 12], "sym_atom_typ": [7, 8], "encoded_atom_typ": [7, 8], "sym_caffeine_edg": [7, 8], "enc_caffeine_edg": [7, 8], "edge_attribut": [7, 8], "sym_bond_typ": [7, 8], "encoded_bond_typ": [7, 8], "sym_4cloro1butino_nod": [7, 8], "enc_4cloro1butino_nod": [7, 8], "sym_4cloro1butino_edg": [7, 8], "enc_4cloro1butino_edg": [7, 8], "translat": [7, 8, 11], "univers": [7, 8], "languag": [7, 8, 12], "integ": [7, 8], "hard": [7, 8, 9, 10], "wrong": [7, 8, 9], "instead": [7, 8, 9, 10, 12, 13], "taught": [7, 8], "contemporari": [7, 8], "bad": [7, 8, 9, 10], "sens": [7, 8, 9, 10, 11], "torch": [7, 8, 10, 11, 12], "nn": [7, 8, 10, 11, 12], "modul": [7, 8, 10, 11, 12], "made": [7, 8, 11, 12], "row": [7, 8, 10, 11, 12], "column": [7, 8, 9, 10, 11, 12], "num_embed": [7, 8, 9, 11, 12], "embedding_dim": [7, 8, 9, 11, 12], "hyper": [7, 8, 10, 12], "higher": [7, 8], "more": [7, 8, 9, 10, 11, 12], "capac": [7, 8, 9, 10, 12], "16": [7, 8, 9, 11, 12], "atom_type_embed": [7, 8], "randn": [7, 8, 9], "embedded_caffeine_nod": [7, 8], "encoded_node_featur": [7, 8], "embedded_atom_typ": [7, 8], "embedded_node_featur": [7, 8], "whatev": [7, 8], "though": [7, 8, 9, 11], "poorli": [7, 8, 10, 12], "bond_type_embed": [7, 8], "embedded_caffeine_edg": [7, 8], "edge_idx": [7, 8], "encoded_edge_featur": [7, 8], "embedded_edge_featur": [7, 8], "convert": [7, 8, 12], "context": [7, 8, 10, 12], "put": [7, 8, 10], "shape": [7, 8, 10, 11, 12], "simplest": [7, 8, 11], "longer": [7, 8, 12], "explicit": [7, 8, 10, 11], "sure": [7, 8, 10, 11, 12, 13], "fine": [7, 8], "caffeine_node_features_stack": [7, 8], "dict": [7, 8, 9, 10, 11, 12], "embedded_featur": [7, 8, 10, 11, 12], "sort": [7, 8, 9, 10, 11, 12], "variable_nam": [7, 8], "defaultdict": [7, 8, 9, 11, 12], "neater": [7, 8, 9], "append": [7, 8, 10, 11, 12], "gather": [7, 8], "stacked_node_featur": [7, 8], "feature_tensor": [7, 8], "nerual": [7, 8, 9], "lot": [7, 8, 10, 11, 12, 13], "prefer": [7, 8], "paralel": [7, 8], "great": [7, 8], "enc_caffeine_nodes_stack": [7, 8], "emb_caffeine_nodes_stack": [7, 8], "encoded_stack": [7, 8], "enc_tensor": [7, 8], "dtype": [7, 8, 10, 11, 12], "long": [7, 8, 10, 11, 12], "emb_tensor": [7, 8], "noth": [7, 8], "fanci": [7, 8], "necessari": [7, 8], "2d": [7, 8, 10], "accord": [7, 8], "bit": [7, 8, 10, 11, 12], "complic": [7, 8, 11], "awai": [7, 8, 11, 12], "deal": [7, 8, 9, 11, 13], "either": [7, 8, 11, 12], "strategi": [7, 8, 10], "actual": [7, 8, 9, 10, 11, 12], "3d": [7, 8, 10], "mathbf": [7, 8, 9, 11, 12], "h": [7, 8, 10, 11, 12], "_": [7, 8, 11, 12], "miss": [7, 8, 11, 12], "pad": [7, 8, 9], "realli": [7, 8, 9, 12], "workshop": [7, 8, 13, 15], "wan": [7, 8, 10, 11], "netork": [7, 8], "tranform": [7, 8], "illustr": [7, 8, 9, 10, 11], "caffeine_nod": [7, 8], "n_node": [7, 8, 10, 11, 12], "axis": [7, 8, 10, 11, 12], "caffeine_nodes_indic": [7, 8], "enumer": [7, 8, 9, 10, 11, 12], "caffeine_edge_features_tensor": [7, 8], "node_u": [7, 8], "node_v": [7, 8], "padded_bond_typ": [7, 8], "padded_bond_type_embed": [7, 8], "pad_idx": [7, 8], "padded_enc_caffeine_edg": [7, 8], "caffeine_edge_encoded_tensor": [7, 8], "encoded_valu": [7, 8], "forc": [7, 8, 12], "undirected": [7, 8], "explictli": [7, 8], "caffeine_embedded_edge_featur": [7, 8], "current": [7, 8, 10, 11, 12], "limit": [7, 8, 9, 10, 11, 12], "re": [7, 8, 9, 10, 11, 12], "pipelin": [7, 8, 10], "done": [7, 8, 10, 11, 12], "far": [7, 8], "messi": [7, 8, 12], "organ": [7, 8, 12], "fragment": [7, 8, 10], "right": [7, 8, 11], "hardcod": [7, 8, 10, 11, 12], "insid": [7, 8, 10], "essent": [7, 8], "string": [7, 8, 11, 12], "access": [7, 8, 10, 11, 12], "metadata": [7, 8, 10, 11, 12], "introduc": [7, 8, 10, 12], "continuousvari": [7, 8, 11, 12], "complet": [7, 8, 12], "sake": [7, 8], "hint": [7, 8], "__init__": [7, 8, 10, 11, 12], "self": [7, 8, 10, 11], "__repr__": [7, 8, 10, 11, 12], "f": [7, 8, 9, 10, 11, 12], "continuousfeatur": [7, 8, 10], "__eq__": [7, 8, 10, 11, 12], "__hash__": [7, 8, 10, 11, 12], "hash": [7, 8, 10, 11, 12], "true": [7, 8, 9, 10, 11, 12], "has_null_valu": [7, 8, 10, 11, 12], "null_valu": [7, 8, 10, 11, 12], "value_to_idx_map": [7, 8, 10, 11, 12], "inv_value_to_idx_map": [7, 8, 10, 11, 12], "null_value_idx": [7, 8, 10, 11, 12], "get_null_idx": [7, 8, 10, 11, 12], "els": [7, 8, 9, 10, 11, 12], "rais": [7, 8, 10, 11, 12], "runtimeerror": [7, 8, 10, 11, 12], "null": [7, 8, 10, 11, 12], "value_to_idx": [7, 8, 10, 11, 12], "idx_to_valu": [7, 8, 10, 11, 12], "idx": [7, 8, 10, 11, 12], "__len__": [7, 8, 10, 11, 12], "categoricalfeatur": [7, 8, 10], "wander": [7, 8], "extra": [7, 8, 10, 11, 12], "method": [7, 8, 9, 11, 12], "object": [7, 8, 10, 11], "meaning": [7, 8], "relev": [7, 8, 10], "behav": [7, 8, 9], "intendend": [7, 8], "even": [7, 8, 9, 10], "multiprocess": [7, 8, 10, 12], "instanc": [7, 8, 10, 11, 12, 13], "content": [7, 8], "foo": [7, 8], "didn": [7, 8, 11], "lookup": [7, 8], "foo_dict": [7, 8], "bar": [7, 8, 9], "keyerror": [7, 8], "atom_type_vari": [7, 8], "ring": [7, 8], "atom_is_aromatic_vari": [7, 8], "is_aromat": [7, 8, 10, 11, 12], "fals": [7, 8, 10, 11, 12], "atom_hydrogens_vari": [7, 8], "num_hydrogen": [7, 8], "atom_vari": [7, 8], "bond_types_vari": [7, 8], "bond_is_aromatic_vari": [7, 8], "bond_vari": [7, 8], "neat": [7, 8], "carri": [7, 8], "around": [7, 8, 11, 12], "ones": [7, 8, 12], "categorical_atom_vari": [7, 8], "var": [7, 8, 10, 11, 12], "isinst": [7, 8, 10, 11, 12], "continuous_atom_vari": [7, 8], "categorical_bond_vari": [7, 8], "continuous_bond_vari": [7, 8], "make_embed": [7, 8], "padding_idx": [7, 8, 11, 12], "atom_embed": [7, 8], "bond_embed": [7, 8], "similarlili": [7, 8], "let": [7, 8, 9, 11, 12], "stacked_encoded_categorical_node_featur": [7, 8], "stacked_continuous_node_featur": [7, 8, 10, 11, 12], "symbolic_valu": [7, 8], "stacked_encoded_categorical_edge_featur": [7, 8], "stacked_continuous_edge_featur": [7, 8, 10, 11, 12], "pairwise_tensor": [7, 8], "float32": [7, 8, 10, 11, 12], "readi": [7, 8, 10, 12], "encoded_featur": [7, 8], "tensor_featur": [7, 8], "continuous_node_featur": [7, 8, 10, 11, 12], "continuous_edge_featur": [7, 8, 10, 11, 12], "final": [7, 8, 10, 11], "aggreg": [7, 8, 10, 12], "stacked_node_embed": [7, 8], "aggregated_node_embed": [7, 8], "dim": [7, 8, 9, 10, 11, 12], "continuous_node_features_stack": [7, 8], "node_featur": [7, 8, 10, 11, 12], "concat": [7, 8], "stacked_edge_embed": [7, 8], "edge_featur": [7, 8, 10, 11, 12], "throw": [7, 8, 12], "continuous_edge_features_stack": [7, 8], "aggregated_edge_embed": [7, 8], "gone": [7, 8], "specif": [7, 8, 9, 10], "depict": [7, 8], "been": [7, 8, 9, 10, 11, 12], "quit": [7, 8, 9, 10, 11, 12], "jurnei": [7, 8], "arduou": [7, 8], "clear": [7, 8, 10], "possibl": [7, 8, 9], "session": [8, 10, 14], "notebook": [8, 9, 10, 11], "colab": [8, 10, 11, 12], "represent": [8, 9, 10, 11, 12], "answer": [8, 10], "apart": [8, 11], "uniqu": 8, "identifi": [8, 10], "tupl": [8, 10, 11, 12], "ad": [8, 10, 11], "mismatch": 8, "compar": [8, 9, 10, 11, 12], "figur": [8, 9, 10, 11], "contain": [8, 9, 10, 11, 12, 13], "would": [8, 9, 11, 12], "g1": 8, "g2": 8, "g3": 8, "g4": 8, "comparison": 8, "result": [8, 9, 10, 11, 12], "equal": [8, 10], "second": [8, 10, 11], "could": [8, 9, 10, 11, 12], "datastructur": [8, 10, 11], "add": [8, 9, 10, 11, 12], "non": [8, 11], "interpret": 8, "write": [8, 11], "ambigu": 8, "convent": 8, "outgo": 8, "converesli": 8, "incom": 8, "As": [8, 9, 10, 11, 12], "entitit": 8, "That": [8, 12], "hold": [8, 9], "ij": 8, "ji": 8, "think": [8, 9, 11, 12], "By": [8, 10, 11, 12], "leav": [8, 10, 11, 12], "load": [8, 10], "desir": [8, 9, 10, 12], "fill": [8, 9, 11, 12], "cell": [8, 10, 11, 13], "matric": [8, 9, 10, 12], "No": [8, 10, 12], "decid": [8, 11, 12], "ident": 8, "arbitrari": [8, 10, 11, 12], "determin": [8, 9], "zero": [8, 9, 10, 11, 12], "entri": [8, 10, 11, 12], "diagon": [8, 12], "loop": 8, "binari": [8, 12], "itself": 8, "state": [8, 10, 11], "function": [8, 10, 12], "produc": [8, 11], "node_to_idx": 8, "node_label": 8, "u_i": 8, "v_i": 8, "caffein": 8, "carbon": 8, "oxygen": 8, "nitrogen": 8, "molecul": [8, 10, 11, 12], "three": [8, 11], "pick": [8, 9, 11, 12], "similar": [8, 9, 10, 11, 12], "red": 8, "green": 8, "advanc": [8, 10], "blue": [8, 9], "expert": 8, "23": 8, "orang": [8, 9], "none": [8, 9, 10, 11, 12], "48": 8, "42": 8, "31": 8, "stj\u00f6trask": 8, "lat": 8, "65": 8, "55": 8, "lon": 8, "18": 8, "91": 8, "kl\u00e4ppen": 8, "69": 8, "88": 8, "r\u00f6nnberg": 8, "70": [8, 9], "19": 8, "30": 8, "arvidsjaur": 8, "59": [8, 12], "pjesker": 8, "52": [8, 10], "67": 8, "grundsel": 8, "66": 8, "20": [8, 9], "aborrtr\u00e4sk": 8, "45": 8, "39": 8, "glommerstr\u00e4sk": 8, "26": 8, "64": [8, 9], "distanc": [8, 12], "15": 8, "27": 8, "24": [8, 9, 12], "35": [8, 9], "32": [8, 9, 10, 11, 12], "54": 8, "multi": [8, 10, 11], "field": [8, 12], "semant": 8, "mathematician": 8, "physicist": 8, "term": [8, 9, 10, 12], "purpos": [8, 10, 11, 12], "valu": [8, 9, 10, 11, 12], "process": [8, 10, 11, 12], "extend": [8, 10, 11, 12], "cl": [8, 10, 11, 12], "reason": [8, 10, 11, 12], "multipli": [8, 9, 11, 12], "z": 8, "w_": 8, "21": 8, "22": 8, "33": 8, "0w_": 8, "1w_": 8, "unintend": 8, "consequ": 8, "lstm": 8, "subtl": [8, 11], "optim": [8, 9, 10, 11, 12], "averag": [8, 12], "gradient": 8, "low": [8, 12], "primarili": [8, 11], "proper": [8, 12], "line": [8, 11], "comment": [8, 11], "emb": [8, 10, 11, 12], "did": [8, 11, 12], "node_u_idx": 8, "node_v_idx": 8, "indirect": 8, "ag": [8, 10, 11, 12], "countri": 8, "resid": 8, "class": [8, 11, 12], "float": [8, 10, 11, 12], "seper": [8, 10], "must": [8, 10, 11, 12], "dedic": [8, 12], "preprocess": [8, 12], "categoricalvari": [8, 11, 12], "argument": [8, 9, 10, 11], "add_null_valu": [8, 10, 11, 12], "downstream": [8, 10, 11, 12], "commonli": [8, 10, 11], "unevenli": 8, "invalid": [8, 10, 11], "parallel": [9, 10, 12], "multihead": 9, "attent": 9, "sai": [9, 11, 12], "argu": 9, "strong": 9, "assumpt": [9, 10], "consist": 9, "free": [9, 11], "includ": [9, 12], "our": [9, 10, 11, 12], "optimz": 9, "appli": [9, 11, 12], "mathord": 9, "r": 9, "k": [9, 10, 11, 12], "word": [9, 11, 12], "select": [9, 10, 11, 12], "easi": [9, 10], "least": [9, 10, 11, 12], "expriss": 9, "u_1": 9, "vdot": [9, 11, 12], "u_k": 9, "v_1": 9, "v_": 9, "construct": [9, 10, 11, 12], "howev": [9, 10, 11, 12], "subspac": 9, "dynam": [9, 10], "analogi": 9, "fulli": 9, "ti": [9, 10, 11, 12], "constraint": 9, "cnn": [9, 11], "exploit": 9, "prior": 9, "belief": 9, "analyz": 9, "spatial": 9, "correl": 9, "date": 9, "bia": [9, 10, 11, 12], "orthogon": 9, "oper": [9, 11, 12], "matrix": [9, 10], "w": [9, 10, 11, 12], "w_u": 9, "w_v": 9, "after": [9, 10, 11, 12], "linearili": 9, "freeli": 9, "parameter": [9, 11], "loos": 9, "anyth": [9, 11, 12], "especi": [9, 10], "increas": 9, "match": 9, "had": [9, 11], "come": [9, 10, 12], "th": [9, 10, 11, 12], "e_u": 9, "e_v": 9, "numpi": [9, 11, 12], "slice": [9, 11, 12], "notat": 9, "achiev": [9, 11, 12], "randomli": [9, 10], "initi": [9, 10, 11], "random": [9, 10, 11, 12], "distribut": [9, 10, 13], "drawn": 9, "permut": [9, 12], "invari": [9, 11, 12], "sequenc": [9, 10, 12], "s_1": 9, "white": 9, "cat": [9, 10, 11, 12], "visit": 9, "hous": 9, "s_2": 9, "w_1": [9, 12], "w_2": [9, 12], "w_3": 9, "w_4": 9, "w_5": 9, "w_6": 9, "fix": 9, "depend": [9, 11, 12, 13], "sentenc": 9, "convers": 9, "problemat": [9, 10, 11, 12], "_1": [9, 12], "_2": [9, 12], "neq": 9, "caus": 9, "2": [9, 10, 12, 14], "feel": 9, "disentangl": 9, "som": 9, "x_1": [9, 11], "x_n": [9, 11], "y": [9, 10, 11, 12], "x_i": [9, 12], "x_j": [9, 11, 12], "difficult": [9, 10], "exactli": [9, 11, 12], "went": 9, "_n": [9, 12], "wont": 9, "destruct": 9, "np": [9, 10, 11, 12], "collect": [9, 10, 11, 12], "counter": 9, "matplotlib": [9, 10, 11, 12], "pyplot": [9, 10, 11, 12], "plt": [9, 10, 11, 12], "seed": [9, 10, 11, 12], "1729": [9, 10, 11, 12], "num_valu": 9, "sample_s": 9, "50": [9, 10, 11, 12], "500": 9, "raw_data_sampl": 9, "128": 9, "embeddings_by_dim": 9, "overlap": 9, "reset": [9, 10], "contigu": 9, "order": [9, 10, 11, 12], "transpos": [9, 12], "back": [9, 10, 11], "embeddings_t": 9, "sampl": 9, "embedded_sampl": 9, "summed_vector": 9, "axi": [9, 10, 11, 12], "iter": [9, 10, 11, 12], "cosin": 9, "dot": [9, 12], "product": [9, 11, 12], "normal": [9, 12], "highest": 9, "retract": 9, "estimate_vector_count": 9, "vector_sum": 9, "top": 9, "embeddings_norm": 9, "linalg": 9, "norm": [9, 10], "1": [9, 10, 12, 14], "keepdim": [9, 11, 12], "count": [9, 11, 12], "x_normal": 9, "cosine_sim": 9, "top_emb_idx": 9, "argmax": 9, "top_emb_vec": 9, "histogram": 9, "subfigur": [9, 11], "estim": [9, 10], "abil": 9, "improv": [9, 10], "dramat": 9, "isn": [9, 10], "supris": 9, "decent": 9, "less": 9, "fig": 9, "ax": 9, "subplot": 9, "nrow": 9, "ncol": 9, "figsiz": 9, "sharex": 9, "sharei": 9, "dpi": 9, "90": 9, "legend": 9, "true_sample_count": 9, "estimated_count": 9, "true_x": 9, "true_i": 9, "zip": 9, "est_x": 9, "est_i": 9, "width": 9, "artist_1": 9, "artist_2": 9, "set_titl": 9, "rotat": 9, "transax": 9, "va": [9, 12], "set_ylabel": 9, "set_xlabel": 9, "simplifi": 9, "visual": 9, "talli": 9, "miscount": 9, "vocabulari": 9, "relat": [9, 11], "get_miscount": 9, "true_count": 9, "est_count": 9, "ab": 9, "miscounts_num_distinct_vector": 9, "lambda": 9, "num_distinct_vector": 9, "1024": 9, "200": 9, "num_vector": 9, "150": 9, "flatten": 9, "miscounts_by_sample_s": 9, "miscounts_by_emb_dim": 9, "emb_dim": 9, "plot": [9, 10], "accuraci": 9, "mechan": 9, "provid": [9, 10], "enough": 9, "opim": 9, "thought": 9, "worst": 9, "shown": 9, "replac": [9, 11, 12], "measur": 9, "equival": [9, 12], "scalar": [9, 11, 12], "togheth": 9, "hope": 9, "likewis": 9, "togeth": [9, 10, 11, 12], "technic": 10, "cleanli": 10, "describ": 10, "raw": 10, "prepar": [10, 11], "gloss": 10, "3": [10, 12, 14], "loader": 10, "instanti": [10, 11], "collat": [10, 12], "ultim": 10, "rdkit": [10, 11, 12], "chem": [10, 11, 12], "molfromsmil": [10, 11, 12], "draw": [10, 11, 12], "ipythonconsol": [10, 11, 12], "ipython_usesvg": [10, 11, 12], "svg": [10, 11, 12], "png": [10, 11, 12], "drawopt": [10, 11, 12], "addatomindic": [10, 11, 12], "molsiz": [10, 11, 12], "300": 10, "util": [10, 11, 12], "abc": [10, 11, 12], "float_typ": [10, 11, 12], "categorical_typ": [10, 11, 12], "mask_typ": [10, 11, 12], "labels_typ": [10, 11, 12], "q": 10, "erik": 10, "atom_symbol": [10, 11, 12], "he": [10, 11, 12], "li": [10, 11, 12], "Be": [10, 11, 12], "ne": [10, 11, 12], "na": [10, 11, 12], "mg": [10, 11, 12], "si": [10, 11, 12], "p": [10, 11, 12], "ca": [10, 11, 12], "sc": [10, 11, 12], "cr": [10, 11, 12], "mn": [10, 11, 12], "fe": [10, 11, 12], "co": [10, 11, 12], "ni": [10, 11, 12], "cu": [10, 11, 12], "zn": [10, 11, 12], "ga": [10, 11, 12], "ge": [10, 11, 12], "se": [10, 11, 12], "br": [10, 11, 12], "kr": [10, 11, 12], "rb": [10, 11, 12], "sr": [10, 11, 12], "zr": [10, 11, 12], "nb": [10, 11, 12], "mo": [10, 11, 12], "tc": [10, 11, 12], "ru": [10, 11, 12], "rh": [10, 11, 12], "pd": [10, 11, 12], "cd": [10, 11, 12], "sn": [10, 11, 12], "sb": [10, 11, 12], "te": [10, 11, 12], "xe": [10, 11, 12], "ba": [10, 11, 12], "hf": [10, 11, 12], "ta": [10, 11, 12], "ir": [10, 11, 12], "pt": [10, 11, 12], "au": [10, 11, 12], "hg": [10, 11, 12], "tl": [10, 11, 12], "pb": [10, 11, 12], "bi": [10, 11, 12], "po": [10, 11, 12], "At": [10, 11, 12], "rn": [10, 11, 12], "fr": [10, 11, 12], "ra": [10, 11, 12], "rf": [10, 11, 12], "db": [10, 11, 12], "sg": [10, 11, 12], "bh": [10, 11, 12], "mt": [10, 11, 12], "rg": [10, 11, 12], "cn": [10, 11, 12], "fl": [10, 11, 12], "lv": [10, 11, 12], "la": [10, 11, 12], "ce": [10, 11, 12], "pr": [10, 11, 12], "nd": [10, 11, 12], "pm": [10, 11, 12], "sm": [10, 11, 12], "eu": [10, 11, 12], "gd": [10, 11, 12], "tb": [10, 11, 12], "dy": [10, 11, 12], "ho": [10, 11, 12], "er": [10, 11, 12], "tm": [10, 11, 12], "yb": [10, 11, 12], "lu": [10, 11, 12], "ac": [10, 11, 12], "pa": [10, 11, 12], "pu": [10, 11, 12], "am": [10, 11, 12], "cm": [10, 11, 12], "bk": [10, 11, 12], "cf": [10, 11, 12], "fm": [10, 11, 12], "md": [10, 11, 12], "lr": [10, 11, 12], "symbols_featur": 10, "aromatic_valu": [10, 11, 12], "aromatic_featur": [10, 11, 12], "valanc": 10, "explicit_valance_featur": 10, "explicit_val": [10, 11, 12], "implicit": 10, "implicit_valance_featur": 10, "implicit_val": [10, 11, 12], "atom_featur": [10, 11, 12], "unspecifi": [10, 11, 12], "tripl": [10, 11, 12], "quadrupl": [10, 11, 12], "quintupl": [10, 11, 12], "hextupl": [10, 11, 12], "oneandahalf": [10, 11, 12], "twoandahalf": [10, 11, 12], "threeandahalf": [10, 11, 12], "fourandahalf": [10, 11, 12], "fiveandahalf": [10, 11, 12], "ionic": [10, 11, 12], "hydrogen": [10, 11, 12], "threecent": [10, 11, 12], "dativeon": [10, 11, 12], "dativ": [10, 11, 12], "dativel": [10, 11, 12], "type_featur": [10, 11, 12], "direct": 10, "bond_direct": [10, 11, 12], "beginwedg": [10, 11, 12], "begindash": [10, 11, 12], "enddownright": [10, 11, 12], "endupright": [10, 11, 12], "eitherdoubl": [10, 11, 12], "direction_featur": [10, 11, 12], "jame": 10, "bond_stereo": [10, 11, 12], "stereonon": [10, 11, 12], "stereoani": [10, 11, 12], "stereoz": [10, 11, 12], "stereo": [10, 11, 12], "stereoci": [10, 11, 12], "stereotran": [10, 11, 12], "stereo_featur": [10, 11, 12], "bond_featur": [10, 11, 12], "get_atom_featur": [10, 11, 12], "rd_atom": [10, 11, 12], "getsymbol": [10, 11, 12], "getisaromat": [10, 11, 12], "getimplicitval": [10, 11, 12], "getexplicitval": [10, 11, 12], "get_bond_featur": [10, 11, 12], "rd_bond": [10, 11, 12], "str": [10, 11, 12], "getbondtyp": [10, 11, 12], "bond_stereo_info": [10, 11, 12], "getstereo": [10, 11, 12], "getbonddir": [10, 11, 12], "dictionari": [10, 11, 12], "rdmol_to_graph": [10, 11, 12], "rd_mol": [10, 11, 12], "getidx": [10, 11, 12], "getatom": [10, 11, 12], "getbeginatomidx": [10, 11, 12], "getendatomidx": [10, 11, 12], "getbond": [10, 11, 12], "smiles_to_graph": [10, 11, 12], "smile": [10, 11, 12], "goal": [10, 12], "protocol": 10, "fact": [10, 11, 12], "mini": [10, 12], "multidimensional": 10, "ndarrai": 10, "along": [10, 11, 12], "addit": [10, 11], "irrelev": 10, "init": [10, 11], "being": [10, 11], "length": [10, 11, 12], "per": [10, 11, 12], "addition": 10, "suppli": [10, 11, 12], "latter": [10, 12], "choos": [10, 11, 12], "recomput": 10, "whole": [10, 11], "csv": [10, 11, 12], "origin": 10, "distict": 10, "contin": 10, "chosen": [10, 11], "keep": [10, 11], "independ": [10, 11, 12], "adjac": 10, "encod": [10, 12], "primari": 10, "prone": 10, "break": [10, 11, 12], "lightweight": 10, "__slots__": 10, "downsid": [10, 11], "help": [10, 11, 12], "upsid": 10, "inspect": 10, "overhead": [10, 11, 12], "datastrucur": 10, "avoid": 10, "graphdataset": [10, 11, 12], "node_vari": [10, 11, 12], "edge_vari": [10, 11, 12], "assert": [10, 11, 12], "categorical_node_vari": [10, 11, 12], "continuous_node_vari": [10, 11, 12], "categorical_edge_vari": [10, 11, 12], "continuous_edge_vari": [10, 11, 12], "make_continuous_node_featur": [10, 11, 12], "n_featur": [10, 11, 12], "continuous_featur": [10, 11, 12], "make_categorical_node_featur": [10, 11, 12], "categorical_node_featur": [10, 11, 12], "categorical_vari": [10, 11, 12], "value_index": [10, 11, 12], "make_continuous_edge_featur": [10, 11, 12], "make_categorical_edge_featur": [10, 11, 12], "categorical_edge_featur": [10, 11, 12], "stuff": [10, 11, 12], "happen": [10, 11, 12], "attribut": [10, 11, 12], "getitem": [10, 11, 12], "clariti": [10, 11, 12], "nodes_idx": [10, 11, 12], "edge_list": [10, 11, 12], "unord": [10, 11, 12], "undirect": [10, 11, 12], "data_record": [10, 11, 12], "advantag": [10, 11, 12], "expect": [10, 11, 12], "present": [10, 11, 12], "unpack": [10, 11, 12], "robust": [10, 11, 12], "entir": [10, 11, 12], "get_node_vari": [10, 11, 12], "get_edge_vari": [10, 11, 12], "make_molecular_graph_dataset": [10, 11, 12], "smiles_record": [10, 11, 12], "record": [10, 11, 12, 14], "c1ccccc1": [10, 11, 12], "ask": 10, "next": [10, 11], "feed": [10, 11], "compon": 10, "propag": [10, 11, 12], "effect": [10, 11, 12], "leak": 10, "across": 10, "batch_siz": [10, 11, 12], "max_nod": [10, 11, 12], "heavi": 10, "conveni": 10, "target": [10, 11, 12], "devic": [10, 11, 12], "stage": [10, 12], "interact": [10, 12], "cuda": [10, 11, 12], "collate_graph_batch": [10, 11, 12], "produdc": [10, 11, 12], "max": [10, 11, 12], "alloc": [10, 11, 12], "defer": [10, 11, 12], "until": [10, 11, 12], "those": [10, 11, 12], "adjacency_matric": [10, 11, 12], "stacked_categorical_node_featur": [10, 11, 12], "stacked_categorical_edge_featur": [10, 11, 12], "nodes_mask": [10, 11, 12], "edge_mask": [10, 11, 12], "has_metadata": [10, 11, 12], "g_node": [10, 11, 12], "valid": [10, 11, 12], "recipi": [10, 11, 12], "g_continuous_node_featur": [10, 11, 12], "num_featur": [10, 11, 12], "g_categorical_node_featur": [10, 11, 12], "g_continuous_edge_featur": [10, 11, 12], "g_categorical_edge_featur": [10, 11, 12], "batch_record": [10, 11, 12], "dataloader_test_batch": 10, "screen": 10, "silico": 10, "candid": 10, "drug": 10, "moleculenet": 10, "benchmark": 10, "org": 10, "assembl": 10, "martin": 10, "teixeira": 10, "pinheiro": 10, "falcao": 10, "journal": 10, "chemic": 10, "2012": 10, "1686": 10, "1697": 10, "whether": [10, 11, 12], "membran": 10, "stream": 10, "extracellular": 10, "fluid": 10, "nervou": 10, "pathlib": [10, 11, 12], "path": [10, 11], "panda": [10, 11, 12], "potential_path": [10, 11, 12], "bbbp": [10, 11, 12], "bbbp_tabl": [10, 11, 12], "exist": [10, 11, 12], "read_csv": [10, 11, 12], "p_np": [10, 11, 12], "unfortun": 10, "malform": 10, "chemistri": [10, 11, 12], "becaus": [10, 11, 12], "remov": [10, 11], "rel": [10, 12], "few": [10, 11], "filter": [10, 11], "labeled_smiles_list": 10, "recommend": 10, "gnn_02": 10, "appendix": 10, "ipynb": 10, "warn": [10, 11], "behaviour": [10, 11], "supress": [10, 11, 12], "pars": [10, 11, 12], "rdlogger": [10, 11, 12], "disablelog": [10, 11, 12], "rdapp": [10, 11, 12], "num": [10, 11, 12], "to_record": [10, 11, 12], "check": [10, 11, 12], "accept": [10, 11, 12], "training_fract": [10, 11, 12], "dev_fract": [10, 11, 12], "n_exampl": [10, 11, 12], "n_training_exampl": [10, 11, 12], "int": [10, 11, 12], "n_dev_exampl": [10, 11, 12], "shuffl": [10, 11, 12], "training_indic": [10, 11, 12], "dev_indic": [10, 11, 12], "test_indic": [10, 11, 12], "training_smiles_record": [10, 11, 12], "dev_smiles_record": [10, 11, 12], "test_smiles_record": [10, 11, 12], "recrord": 10, "interest": [10, 11, 12], "misspredict": 10, "knowledg": [10, 12], "training_graph_dataset": [10, 11, 12], "dev_graph_dataset": [10, 11, 12], "test_graph_dataset": [10, 11, 12], "belong": 10, "pictor": 10, "example_graph": [10, 11], "rdmol": [10, 12], "why": [10, 11], "ever": 10, "altern": 10, "coordin": 10, "Will": 10, "sparseedgesgraphdataset": 10, "collate_sparse_graph_batch": 10, "sparse_continuous_edge_featur": 10, "sparse_categorical_edge_featur": 10, "remaind": [10, 11], "built": [10, 11], "briefli": 10, "extens": 10, "modulelist": [10, 11, 12], "sequenti": [10, 11, 12], "relu": [10, 11, 12], "layernorm": [10, 11, 12], "dropout": [10, 11, 12], "layer_norm": [10, 11, 12], "basicgnnconfig": [10, 11], "d_model": [10, 11, 12], "n_layer": [10, 11, 12], "residual_connect": [10, 12], "bool": [10, 12], "ffn_dim": [10, 11, 12], "prediction_head_dim": 10, "dropout_r": [10, 12], "graph_pool": 10, "graphlay": [10, 11], "config": [10, 11, 12], "neighbour_transform": [10, 12], "skip": [10, 11], "center_node_transform": 10, "output_transform": [10, 12], "nonlinear": [10, 11], "memory_st": [10, 11, 12], "node_mask": [10, 11, 12], "neighbour_st": 10, "center_st": 10, "heart": 10, "matrici": 10, "were": [10, 11], "neighbourhood": [10, 11, 12], "aggregated_neighbourhood": [10, 11, 12], "bmm": 10, "transformed_st": 10, "updated_memory_st": 10, "masked_memory_st": 10, "unsqueez": [10, 11, 12], "basicgnn": 10, "output_dim": [10, 11, 12], "layer_typ": [10, 11, 12], "continuous_vari": [10, 11, 12], "categorical_node_embeddings_dim": [10, 11, 12], "categorical_edge_embeddings_dim": [10, 11, 12], "node_embed": 10, "edge_embed": 10, "notic": [10, 11, 12], "graph_lay": [10, 11, 12], "prediction_head": [10, 11, 12], "busi": [10, 11, 12], "smaller": [10, 11, 12], "than": [10, 11, 12], "maximum": [10, 11, 12], "broadcast": [10, 11, 12], "last": [10, 11, 12, 14], "trail": [10, 11, 12], "masked_node_featur": [10, 11, 12], "memori": [10, 12], "batch_dim": 10, "calcul": [10, 11, 12], "summed_memory_st": 10, "dimen": 10, "mean_memory_st": 10, "infrastructur": 10, "move": [10, 11, 12], "default": [10, 11, 12], "gpu": 10, "runtim": 10, "acceler": 10, "trainer": [10, 11, 12], "tqdm": [10, 11, 12], "trang": [10, 11, 12], "bcewithlogitsloss": [10, 11, 12], "adamw": [10, 11, 12], "sklearn": [10, 11, 12], "metric": [10, 11, 12], "roc_auc_scor": [10, 11, 12], "is_avail": [10, 11, 12], "cpu": [10, 11, 12], "mseloss": [10, 11, 12], "mean_squared_error": [10, 11, 12], "mean_absolute_error": [10, 11, 12], "median_absolute_error": [10, 11, 12], "seaborn": [10, 11, 12], "batch_to_devic": [10, 11, 12], "moved_batch": [10, 11, 12], "is_tensor": [10, 11, 12], "loss_fn": [10, 11, 12], "training_dataload": [10, 11, 12], "dev_dataload": [10, 11, 12], "total_epoch": [10, 11, 12], "1e": [10, 11, 12], "epoch": [10, 11, 12], "desc": [10, 11, 12], "epoch_progress": [10, 11, 12], "batches_per_epoch": [10, 11, 12], "train_loss": [10, 11, 12], "train_n": [10, 11, 12], "training_batch": [10, 11, 12], "zero_grad": [10, 11, 12], "loss": [10, 11, 12], "squeez": [10, 11, 12], "backward": [10, 11, 12], "batch_n": [10, 11, 12], "dev_predict": [10, 11, 12], "dev_label": [10, 11, 12], "dev_n": [10, 11, 12], "dev_loss": [10, 11, 12], "dev_batch": [10, 11, 12], "eval": [10, 11, 12], "no_grad": [10, 11, 12], "tolist": [10, 11, 12], "set_descript": [10, 11, 12], "3f": [10, 11, 12], "evaluate_model": [10, 11, 12], "hue_ord": [10, 11, 12], "eval_predict": [10, 11, 12], "eval_label": [10, 11, 12], "eval_loss": [10, 11, 12], "eval_n": [10, 11, 12], "eval_batch": [10, 11, 12], "average_loss": [10, 11, 12], "roc_auc": [10, 11, 12], "eval_df": [10, 11, 12], "datafram": [10, 11, 12], "kdeplot": [10, 11, 12], "hue": [10, 11, 12], "rugplot": [10, 11, 12], "titl": [10, 11, 12], "nloss": [10, 11, 12], "nroc": [10, 11, 12], "auc": [10, 11, 12], "toggl": 10, "residu": [10, 11, 12], "small": [10, 11, 12], "mlp": [10, 11, 12], "control": 10, "hidden": [10, 11, 12], "larger": [10, 11], "pool": [10, 11, 12], "num_dataloader_work": [10, 11, 12], "num_work": [10, 11, 12], "collate_fn": [10, 11, 12], "drop_last": [10, 11, 12], "test_dataload": [10, 11, 12], "manual_se": [10, 11, 12], "tune": 10, "specifi": [10, 12], "scratch": 10, "evalu": 10, "better": [10, 12], "view": 10, "summari": 10, "roc": 10, "score": [10, 12], "densiti": 10, "logit": [10, 12], "fit": 10, "condit": 10, "unlik": 10, "overfit": 10, "yet": 10, "subsect": 10, "sweet": 10, "spot": 10, "mind": [10, 11, 12], "perfect": 10, "third": 11, "designspac": 11, "larg": 11, "simiilar": 11, "previous": [11, 12], "given": [11, 12], "With": [11, 12], "handli": 11, "vari": 11, "fector": 11, "minimum": 11, "turn": 11, "whose": 11, "power": [11, 12], "distinguish": 11, "upper": 11, "bound": 11, "weisfeil": 11, "lehman": 11, "test": 11, "coverag": 11, "youtu": 11, "usfnjnepdkq": 11, "buzshta4hg": 11, "653": 11, "throughout": 11, "flexibl": 11, "arbitrarili": 11, "again": [11, 12], "__getitem__": [11, 12], "mol": [11, 12], "600": [11, 12], "further": [11, 12], "down": [11, 12], "intern": [11, 12], "mask": [11, 12], "atom_symbols_featur": [11, 12], "atom_aromatic_valu": [11, 12], "atom_aromatic_featur": [11, 12], "categro": [11, 12], "valenc": [11, 12], "demonstr": [11, 12], "atom_explicit_valence_featur": [11, 12], "atom_implicit_valence_featur": [11, 12], "adjacency_list": [11, 12], "charact": 11, "stori": 11, "compact": 11, "01": 11, "toward": [11, 12], "mostli": [11, 12], "dataclass": 11, "net": 11, "anywai": 11, "albeit": 11, "slightli": 11, "uncommon": [11, 12], "assing": [11, 12], "categorical_featur": [11, 12], "all_embedded_var": [11, 12], "ellipsi": [11, 12], "style": [11, 12], "var_indic": [11, 12], "embedded_var": [11, 12], "stacked_embedded_var": [11, 12], "stack": [11, 12], "nodeembedd": 11, "num_categorical_node_vari": 11, "num_continuous_node_vari": 11, "node_embedding_dim": 11, "node_embedd": 11, "span": 11, "space": [11, 12], "agnost": [11, 12], "full_featur": [11, 12], "nodefeatur": 11, "won": 11, "rememb": 11, "besid": 11, "num_categorical_edge_vari": 11, "num_continuous_edge_vari": 11, "edge_embedding_dim": 11, "edge_embedd": 11, "num_node_featur": 11, "num_nod": 11, "num_edge_featur": 11, "underli": [11, 12], "behind": 11, "rout": 11, "success": [11, 12], "perceptron": 11, "pixel": 11, "face": 11, "amount": 11, "neighbour": [11, 12], "taken": 11, "sum_": 11, "_j": [11, 12], "bag": 11, "setup": 11, "compos": 11, "reciev": 11, "adjacencylistgraphlay": 11, "input_dim": [11, 12], "neighbour_mlp": 11, "center_mlp": 11, "output_mlp": 11, "neighbour_updated_node_featur": 11, "center_updated_node_featur": 11, "rembemb": 11, "vectror": 11, "neighbour_idx": 11, "center_nod": 11, "updated_node_featur": [11, 12], "adjacency_list_graph_lay": 11, "sum_j": 11, "written": 11, "x_2": 11, "And": [11, 12], "ddot": [11, 12], "ye": 11, "innefi": 11, "unless": 11, "pave": 11, "adjacencymatrixgraphlay": 11, "adjacencti": 11, "matmul": [11, 12], "_batched_": 11, "adjacency_matrix_graph_lay": 11, "list_result": 11, "matrix_result": 11, "h_i": 11, "f_c": 11, "f_n": 11, "h_j": 11, "e_": [11, 12], "neigbhour": 11, "adjacencylistedgefeaturesgraphlay": 11, "neighbour_edges_mlp": 11, "chose": 11, "featuer": 11, "induct": 11, "matter": 11, "neighbour_edge_vector": 11, "adjacency_list_edge_features_graph_lay": 11, "walk": 11, "everi": 11, "x_": [11, 12], "everywher": 11, "circ": 11, "ignor": [11, 12], "reduc": [11, 12], "ineffici": 11, "denser": 11, "adjacencymatrixedgefeaturesgraphlay": 11, "essential": 11, "potenti": [11, 12], "edge_and_node_featur": 11, "corresond": 11, "masked_edge_and_node_featur": 11, "compactli": 11, "einsum": 11, "hopefulli": 11, "clearer": 11, "reduced_neighbourhood": 11, "adjacency_matrix_edge_features_graph_lay": 11, "list_edge_feature_result": 11, "matrix_edge_feature_result": 11, "mention": 11, "bring": 11, "example_batch": [11, 12], "lead": 11, "_broadcast_": 11, "masked_edge_featur": [11, 12], "challang": 11, "correctli": 11, "basicgraphlay": 11, "agnositc": 11, "shouldn": 11, "singelton": 11, "compat": 11, "masked_updated_featur": 11, "batched_graph_lay": 11, "batch_graph_lay": 11, "old": 11, "batched_implement": 11, "old_implement": 11, "redifin": 11, "basicgraphencod": 11, "basic_config": 11, "basic_gnn_encod": 11, "reduct": 11, "reduce_node_featur": 11, "feature_dim": [11, 12], "respect": 11, "reduced_node_featur": 11, "elif": [11, 12], "largest": 11, "total": [11, 12], "node_sum": 11, "node_count": [11, 12], "summed_node_featur": 11, "reduced_batch": 11, "reduced_single_exampl": 11, "preivou": 11, "dequ": [11, 12], "murckoscaffold": [11, 12], "murckoscaffoldsmilesfromsmil": [11, 12], "canon": 11, "dev": [11, 12], "flesh": 11, "graphpredictionhead": [11, 12], "gnnencod": 11, "graphpredictionneuralnetwork": [11, 12], "graphpredictionheadconfig": [11, 12], "pooling_typ": [11, 12], "kwarg": [11, 12], "predictor": [11, 12], "leading_axis": [11, 12], "pooled_nod": [11, 12], "valueerror": [11, 12], "unsupport": [11, 12], "graph_layer_typ": 11, "observ": 11, "suffer": 11, "diffus": 11, "remedi": 11, "f_": 11, "graphencod": 11, "resdiualgraphlay": 11, "residualgraphencod": 11, "residualgraphlay": 11, "residualgraphpredictionneuralnetwork": 11, "spent": 11, "embedd": 12, "featurecombin": 12, "download": 12, "propanolol": 12, "ncc": 12, "coc1cccc2ccccc12": 12, "terbutylchlorambucil": 12, "oc": 12, "cccc1ccc": 12, "cc1": 12, "cccl": 12, "40730": 12, "c12c3c": 12, "n4ccn": 12, "cc4": 12, "cc1c": 12, "cn2c": 12, "c1ccn": 12, "cc1cccc": 12, "c1": 12, "occcnc": 12, "cloxacillin": 12, "cc1onc": 12, "c2ccccc2cl": 12, "c1c": 12, "4sc": 12, "2045": 12, "2049": 12, "licostinel": 12, "c2": 12, "c1nc": 12, "n2": 12, "2046": 12, "2050": 12, "ademetionin": 12, "adenosyl": 12, "methionin": 12, "2c1": 12, "nc": 12, "n1": 12, "2047": 12, "2051": 12, "mesocarb": 12, "nc2": 12, "cc3": 12, "2048": 12, "2052": 12, "tofisolin": 12, "cc2": 12, "c2cc": 12, "nh": 12, "c3": 12, "2053": 12, "azidamfenicol": 12, "logger": 12, "haven": 12, "printout": 12, "c1nccscc2ncccc2": 12, "cc3ccccc3": 12, "nh2": 12, "sc1": 12, "csccnc": 12, "61": 12, "cc1nc": 12, "391": 12, "s1cc": 12, "csccn": 12, "nc1": 12, "614": 12, "ncc1": 12, "642": 12, "n1c": 12, "csc1": 12, "645": 12, "c1cccc": 12, "646": 12, "647": 12, "648": 12, "649": 12, "c2cccc": 12, "ccc1": 12, "685": 12, "thankfulli": 12, "divis": 12, "summed_feature_vector": 12, "neighourhood": 12, "a_i": 12, "ah": 12, "recept": 12, "bias": 12, "pattern": 12, "adjacenct": 12, "calcualt": 12, "h_1": 12, "h_2": 12, "h_n": 12, "distant": 12, "inject": 12, "major": 12, "implictli": 12, "muiltipli": 12, "cost": 12, "todo": 12, "degre": 12, "quadrat": 12, "scale": 12, "sever": 12, "regardless": 12, "stop": 12, "wildli": 12, "natur": 12, "medicin": 12, "brute": 12, "aparticular": 12, "basictransformerlay": 12, "basictransformerencod": 12, "math": 12, "softmax": 12, "basictransformerconfig": 12, "head_dim": 12, "lower": 12, "center_transform": 12, "attention_norm": 12, "output_norm": 12, "scaling_factor": 12, "sqrt": 12, "attention_funct": 12, "center_node_featur": 12, "neighbour_node_featur": 12, "squar": 12, "root": 12, "outer": 12, "multplic": 12, "attention_logit": 12, "adjcenc": 12, "lowest": 12, "imagin": 12, "inf": 12, "boolean": 12, "nodemask_2d": 12, "nodemask": 12, "invert": 12, "hi": 12, "fill_mask": 12, "masked_fill_": 12, "attention_matrix": 12, "nan": 12, "masked_fil": 12, "formul": 12, "pretti": 12, "_compute_": 12, "masked_featur": 12, "resiud": 12, "encoded_graph": 12, "basic_encoder_config": 12, "basic_transform": 12, "head_config": 12, "strucutur": 12, "modifi": 12, "stick": 12, "frac": 12, "learnabl": 12, "influenc": 12, "prescenc": 12, "adjacencytransformerlay": 12, "arg": 12, "adjacency_weight": 12, "dot_product_logit": 12, "adjust": 12, "presenc": 12, "adjacency_logit": 12, "notion": 12, "sigma": 12, "b_1": 12, "b_2": 12, "edgeattributesattentiontransformerlay": 12, "attention_score_funct": 12, "leading_dimens": 12, "rd": 12, "annyo": 12, "consciou": 12, "attention_score_input": 12, "integr": 12, "contexu": 12, "edgeattributestransformerlay": 12, "context_dependent_featur": 12, "tricki": 12, "multiplact": 12, "attended_featur": 12, "tend": 12, "struggl": 12, "euclidean": 12, "shortest": 12, "augment": 12, "chen": 12, "benson": 12, "max_path_length": 12, "truncat": 12, "recurr": 12, "simpler": 12, "itertool": 12, "rdmolop": 12, "getshortestpath": 12, "pairwise_featur": 12, "careat": 12, "path_featur": 12, "path_var": 12, "feature_kw": 12, "path_var_nam": 12, "_p": 12, "path_var_valu": 12, "get_shortest_paths_bond_featur": 12, "get_pairwise_featur": 12, "rd_atom_a": 12, "rd_atom_b": 12, "getbondbetweenatom": 12, "shorter": 12, "shortest_path": 12, "path_bond_vari": 12, "path_bond": 12, "path_bond_featur": 12, "cccccc": 12, "atom_a": 12, "getatomwithidx": 12, "atom_b": 12, "bond_direction_p0": 12, "bond_direction_p1": 12, "bond_direction_p2": 12, "bond_stereo_p0": 12, "bond_stereo_p1": 12, "bond_stereo_p2": 12, "bond_type_p0": 12, "bond_type_p1": 12, "bond_type_p2": 12, "is_aromatic_p0": 12, "is_aromatic_p1": 12, "is_aromatic_p2": 12, "rdmol_to_complete_graph": 12, "all_pairwise_featur": 12, "smiles_to_complete_graph": 12, "process_smiles_record": 12, "make_graph_shortest_path_dataset": 12, "diamet": 12, "imap": 12, "training_shortest_path_dataset": 12, "dev_shortest_path_dataset": 12, "test_shortest_path_dataset": 12, "training_shortest_path_dataload": 12, "dev_shortest_path_dataload": 12, "test_shortest_path_dataload": 12, "slower": 12, "consum": 12, "processor": 12, "hardwar": 12, "demand": 12, "nlp": 12, "futur": 12, "took": 12, "short": 12, "conceptu": 12, "msg": 12, "agg": 12, "condacolab": 13, "autom": 13, "instal": 13, "anaconda": 13, "depenc": 13, "pip": 13, "_preamble_": 13, "conda": 13, "restart": 13, "execut": 13, "minut": 13, "introductori": 14, "dai": 14, "outro": 14, "sesion": 14, "intro": 14, "slide": 14, "found": 14, "cheat": 15, "sheet": 15}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"from": [0, 1, 7, 8, 11, 12], "molecul": [0, 7], "pytorch": 0, "tensor": [0, 7, 8], "workshop": [0, 1, 2, 3, 5, 6], "notebook": [0, 1, 2, 3, 5, 6, 12, 13], "self": [0, 1, 3, 12], "studi": [0, 1, 3], "graph": [1, 3, 5, 7, 8, 10, 11, 12], "neural": [1, 5, 7, 8, 10, 11], "network": [1, 5, 7, 8, 10, 11], "ground": 1, "up": [1, 7, 8, 11], "gnn": [2, 11, 12], "transform": [2, 5, 9, 12], "basic": 3, "instructor": 4, "": 4, "guid": [4, 5], "prerequisit": 5, "present": [5, 14], "colab": [5, 13], "session": [5, 11], "1": [5, 7, 8, 11], "extra": 5, "materi": [5, 6], "2": [5, 7, 8, 11], "3": [5, 7, 8, 11], "4": [5, 11], "refer": [5, 15], "cluster": 5, "who": 5, "i": [5, 7, 9, 12], "cours": 5, "about": [5, 12], "lesson": 5, "format": 5, "see": 5, "also": 5, "credit": 5, "run": 6, "lumi": 6, "super": 6, "comput": [6, 12], "prerequesit": 6, "copi": 6, "start": 6, "jupyt": 6, "server": 6, "repres": [7, 8, 12], "code": [7, 8, 10, 12], "question": [7, 8, 10, 11], "why": [7, 8, 9], "mismatch": 7, "number": 7, "edg": [7, 8, 10, 11, 12], "compar": 7, "figur": 7, "undirect": [7, 8], "permut": [7, 8], "invari": [7, 8], "python": [7, 8], "comparison": 7, "result": 7, "differ": 7, "g1": 7, "g2": 7, "v": [7, 10], "g3": 7, "g4": 7, "how": [7, 11], "could": 7, "you": [7, 9], "an": [7, 8], "us": [7, 8, 9, 11], "list": [7, 10, 11], "tupl": 7, "e": 7, "order": [7, 8], "datastructur": 7, "The": [7, 8, 10, 11, 12], "adjac": [7, 8, 11, 12], "matrix": [7, 8, 11, 12], "task": [7, 8, 10, 11, 12], "fill": 7, "follow": [7, 9], "text": 7, "cell": 7, "below": 7, "direct": [7, 8], "For": 7, "each": 7, "abov": 7, "ar": 7, "matric": [7, 11], "uniqu": 7, "what": [7, 10, 12], "would": 7, "non": 7, "zero": 7, "entri": 7, "diagon": 7, "encod": [7, 8, 11], "when": [7, 9], "we": [7, 11], "want": 7, "implement": [7, 9, 10, 11, 12], "function": [7, 11], "which": 7, "take": [7, 11], "set": [7, 10], "produc": 7, "attribut": [7, 8], "three": 7, "pick": 7, "one": [7, 8], "similar": 7, "represent": 7, "caffein": 7, "exampl": [7, 11], "dictionari": [7, 8], "structur": [7, 8, 12], "node": [7, 8, 10], "continu": [7, 8, 10, 11], "variabl": [7, 8, 11], "discret": [7, 8], "extend": 7, "embed": [7, 8, 9, 11], "roll": [7, 8], "our": [7, 8], "own": [7, 8], "block": 7, "doe": 7, "line": 7, "comment": 7, "do": [7, 11], "emb": 7, "featur": [7, 8, 10, 11, 12], "like": 7, "did": 7, "creat": [7, 8], "chang": [7, 8], "oper": [7, 8], "In": [7, 11], "reason": 7, "node_u_idx": 7, "node_v_idx": 7, "think": 7, "ad": [7, 12], "none": 7, "valu": 7, "multipl": [7, 8], "book": [7, 8], "keep": [7, 8], "look": [7, 10], "categoricalvari": 7, "class": [7, 10], "purpos": 7, "argument": 7, "add_null_valu": 7, "per": [7, 8], "stack": [7, 8, 10], "combin": [7, 8, 11], "can": 7, "identifi": 7, "process": 7, "blue": 7, "apart": 7, "pre": 7, "wrap": [7, 8], "solut": [8, 11], "hot": 8, "vector": [8, 9, 11], "sum": 9, "concaten": 9, "better": 9, "than": 9, "aggreg": [9, 11], "problem": 9, "decid": 9, "dimension": [9, 11], "linear": 9, "high": 9, "dimens": 9, "shouldn": 9, "t": [9, 11], "dataset": [10, 11], "dataload": 10, "train": [10, 11, 12], "content": 10, "data": [10, 11], "mask": 10, "defin": 10, "categor": 10, "__getitem__": 10, "method": 10, "return": 10, "pack": 10, "where": 10, "experi": 10, "blood": 10, "brain": 10, "barrier": 10, "penetr": 10, "split": 10, "build": 10, "option": [10, 11], "model": 10, "loop": [10, 11], "configur": 10, "predict": 10, "dev": 10, "test": 10, "fundament": 11, "challeng": 11, "go": 11, "size": 11, "input": 11, "fix": 11, "bottom": 11, "No": 11, "batch": 11, "simpl": 11, "layer": 11, "convolut": 11, "messag": 11, "instead": 11, "isn": 11, "thi": [11, 12], "terribli": 11, "inneffici": 11, "wai": 11, "step": [11, 12], "mini": 11, "collat": 11, "embedd": 11, "featurecombin": 11, "5": 11, "put": 11, "toghet": 11, "6": 11, "7": 11, "summari": 11, "previou": 12, "dynam": 12, "downsid": 12, "attent": 12, "pairwis": 12, "path": 12, "inform": 12, "slow": 12, "A": 12, "note": 12, "effici": 12, "learn": 12, "outcom": 12, "import": 12, "concept": 12, "multi": 12, "head": 12, "quick": 15}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx": 57}, "alltitles": {"From molecules to PyTorch Tensors": [[0, "from-molecules-to-pytorch-tensors"]], "Workshop notebook": [[0, "workshop-notebook"], [2, "workshop-notebook"]], "Self-study notebooks": [[0, "self-study-notebooks"], [1, "self-study-notebooks"], [3, "self-study-notebooks"]], "Graph Neural Networks from the ground up": [[1, "graph-neural-networks-from-the-ground-up"]], "Workshop notebooks:": [[1, "workshop-notebooks"]], "GNNs to Transformers": [[2, "gnns-to-transformers"], [12, "gnns-to-transformers"]], "Graph Basics": [[3, "graph-basics"]], "Workshop notebooks": [[3, "workshop-notebooks"]], "Instructor\u2019s guide": [[4, "instructor-s-guide"]], "Graph Neural Networks and Transformer workshop": [[5, "graph-neural-networks-and-transformer-workshop"]], "Prerequisites": [[5, "prerequisites-0"]], "Presentations": [[5, null], [14, "presentations"]], "Notebooks and colab": [[5, null]], "Session 1": [[5, null]], "Session 1 extra material": [[5, null]], "Session 2": [[5, null]], "Session 3": [[5, null]], "Session 4": [[5, null]], "Reference": [[5, null]], "Cluster guide": [[5, null]], "Who is the course for?": [[5, "who-is-the-course-for"]], "About the course": [[5, "about-the-course"]], "Lesson format": [[5, "lesson-format"]], "See also": [[5, "see-also"]], "Credits": [[5, "credits"]], "Running the material on the LUMI super computer": [[6, "running-the-material-on-the-lumi-super-computer"]], "Prerequesits": [[6, "prerequesits"]], "Copying the workshop material": [[6, "copying-the-workshop-material"]], "Starting a jupyter notebook server": [[6, "starting-a-jupyter-notebook-server"]], "Representing graphs for neural networks": [[7, "representing-graphs-for-neural-networks"], [8, "representing-graphs-for-neural-networks"]], "Representing graphs in code": [[7, "representing-graphs-in-code"], [8, "representing-graphs-in-code"]], "Question: Why is there a mismatch in number of edges in the code compared to the figure?": [[7, "question-why-is-there-a-mismatch-in-number-of-edges-in-the-code-compared-to-the-figure"]], "Undirected graph and permutation invariance": [[7, "undirected-graph-and-permutation-invariance"], [8, "undirected-graph-and-permutation-invariance"]], "Permutation invariance in python": [[7, "permutation-invariance-in-python"], [8, "permutation-invariance-in-python"]], "Question: Why is the comparison results different for g1 and g2 vs. g3 and g4?": [[7, "question-why-is-the-comparison-results-different-for-g1-and-g2-vs-g3-and-g4"]], "Question: How could you represent an undirected graph using lists or tuples for the edges (i.e. ordered datastructures)?": [[7, "question-how-could-you-represent-an-undirected-graph-using-lists-or-tuples-for-the-edges-i-e-ordered-datastructures"]], "The Adjacency matrix": [[7, "the-adjacency-matrix"], [8, "the-adjacency-matrix"]], "Task: Fill in the adjacency matrix for the following graph in the text cell below it": [[7, "task-fill-in-the-adjacency-matrix-for-the-following-graph-in-the-text-cell-below-it"]], "Task: Fill in the adjacency matrix for the following directed graph in the text cell below it": [[7, "task-fill-in-the-adjacency-matrix-for-the-following-directed-graph-in-the-text-cell-below-it"]], "Question: For each of the graphs above, are their adjacency matrices unique? Why/why not?": [[7, "question-for-each-of-the-graphs-above-are-their-adjacency-matrices-unique-why-why-not"]], "Question: What would a non-zero entry in the diagonal of the adjacency matrix encode, and when would we want to use that?": [[7, "question-what-would-a-non-zero-entry-in-the-diagonal-of-the-adjacency-matrix-encode-and-when-would-we-want-to-use-that"]], "Task: implement the function below which takes a set of edges and produces an adjacency matrix": [[7, "task-implement-the-function-below-which-takes-a-set-of-edges-and-produces-an-adjacency-matrix"]], "Graph attributes": [[7, "graph-attributes"], [8, "graph-attributes"]], "Task: Below are three graphs, pick one and encode it using a similar representation as the caffeine example above": [[7, "task-below-are-three-graphs-pick-one-and-encode-it-using-a-similar-representation-as-the-caffeine-example-above"]], "Graph 1": [[7, "graph-1"], [8, "graph-1"]], "Graph 2": [[7, "graph-2"], [8, "graph-2"]], "Graph 3": [[7, "graph-3"], [8, "graph-3"]], "From dictionaries to tensors": [[7, "from-dictionaries-to-tensors"], [8, "from-dictionaries-to-tensors"]], "The graph structure": [[7, "the-graph-structure"], [8, "the-graph-structure"]], "Node and edge attributes": [[7, "node-and-edge-attributes"], [8, "node-and-edge-attributes"]], "Continuous variable": [[7, "continuous-variable"], [8, "continuous-variable"]], "Discrete variables": [[7, "discrete-variables"], [8, "discrete-variables"]], "Task: Extend the code example below to encode the following molecule": [[7, "task-extend-the-code-example-below-to-encode-the-following-molecule"]], "Embeddings": [[7, "embeddings"], [8, "embeddings"]], "Roll our own embeddings": [[7, "roll-our-own-embeddings"], [8, "roll-our-own-embeddings"]], "Question: in the embedding code block above, what does the line with a comment do?": [[7, "question-in-the-embedding-code-block-above-what-does-the-line-with-a-comment-do"]], "Task: Embed the edge features like we did with the node features above": [[7, "task-embed-the-edge-features-like-we-did-with-the-node-features-above"]], "Creating tensors": [[7, "creating-tensors"], [8, "creating-tensors"]], "Node features": [[7, "node-features"], [8, "node-features"]], "Change order of operations": [[7, "change-order-of-operations"], [8, "change-order-of-operations"]], "Edge features": [[7, "edge-features"], [8, "edge-features"], [11, "edge-features"], [11, "id1"]], "Question: In the code block above, what is the reason for creating node_u_idx and node_v_idx?": [[7, "question-in-the-code-block-above-what-is-the-reason-for-creating-node-u-idx-and-node-v-idx"]], "Question: Why do you think we added a None value in the code above?": [[7, "question-why-do-you-think-we-added-a-none-value-in-the-code-above"]], "Multiple features": [[7, "multiple-features"], [8, "multiple-features"]], "Feature book keeping": [[7, "feature-book-keeping"], [8, "feature-book-keeping"]], "Question: look at the CategoricalVariable class below. What is the purpose of the argument add_null_value?": [[7, "question-look-at-the-categoricalvariable-class-below-what-is-the-purpose-of-the-argument-add-null-value"]], "Encoding multiple attributes per node and edge": [[7, "encoding-multiple-attributes-per-node-and-edge"], [8, "encoding-multiple-attributes-per-node-and-edge"]], "Per-variable Embeddings": [[7, "per-variable-embeddings"], [8, "per-variable-embeddings"]], "Stacking encoded features for multiple variables": [[7, "stacking-encoded-features-for-multiple-variables"], [8, "stacking-encoded-features-for-multiple-variables"]], "Embedding the stacked and encoded features": [[7, "embedding-the-stacked-and-encoded-features"], [8, "embedding-the-stacked-and-encoded-features"]], "Combining the embedded and continuous features": [[7, "combining-the-embedded-and-continuous-features"], [8, "combining-the-embedded-and-continuous-features"]], "Question: Can you identify the code above for each of the different processing blocks (non-blue) below (apart from pre-processing)?": [[7, "question-can-you-identify-the-code-above-for-each-of-the-different-processing-blocks-non-blue-below-apart-from-pre-processing"]], "Wrapping up": [[7, "wrapping-up"], [8, "wrapping-up"]], "Question": [[8, "exercise-0"], [8, "exercise-1"], [8, "exercise-2"], [8, "exercise-5"], [8, "exercise-6"], [8, "exercise-10"], [8, "exercise-12"], [8, "exercise-13"], [8, "exercise-14"], [8, "exercise-15"]], "Solution": [[8, "solution-0"], [8, "solution-1"], [8, "solution-2"], [8, "solution-3"], [8, "solution-4"], [8, "solution-5"], [8, "solution-6"], [8, "solution-7"], [8, "solution-8"], [8, "solution-9"], [8, "solution-10"], [8, "solution-11"], [8, "solution-12"], [8, "solution-13"], [11, "solution-0"], [11, "solution-1"], [11, "solution-2"], [11, "solution-3"], [11, "solution-4"]], "Adjacency matrix of a directed graph": [[8, "adjacency-matrix-of-a-directed-graph"]], "Adjacency matrix of an undirected graph": [[8, "adjacency-matrix-of-an-undirected-graph"]], "Task": [[8, "exercise-3"], [8, "exercise-4"], [8, "exercise-7"], [8, "exercise-8"], [8, "exercise-9"], [8, "exercise-11"], [10, "task"], [12, "task"]], "Why not use one-hot vectors in neural networks": [[8, "why-not-use-one-hot-vectors-in-neural-networks"]], "Summing or concatenating embeddings?": [[9, "summing-or-concatenating-embeddings"]], "Why is summing embeddings better than concatenation for aggregating vectors?": [[9, "why-is-summing-embeddings-better-than-concatenation-for-aggregating-vectors"]], "Problem with concatenation - decide on dimensionality": [[9, "problem-with-concatenation-decide-on-dimensionality"]], "Implementing concatenation using a sum": [[9, "implementing-concatenation-using-a-sum"]], "Concatenation and sums when followed by a linear transformation": [[9, "concatenation-and-sums-when-followed-by-a-linear-transformation"]], "Sums of vectors in high dimensions": [[9, "sums-of-vectors-in-high-dimensions"]], "When you shouldn\u2019t sum vectors": [[9, "when-you-shouldn-t-sum-vectors"]], "Datasets, Dataloaders and Training": [[10, "datasets-dataloaders-and-training"]], "List of contents": [[10, "list-of-contents"]], "The Graph Data": [[10, "the-graph-data"], [11, "the-graph-data"]], "The Dataset class": [[10, "the-dataset-class"]], "Masking": [[10, "masking"]], "Defining the dataset": [[10, "defining-the-dataset"]], "Continuous vs. Categorical features": [[10, "continuous-vs-categorical-features"]], "The __getitem__ method": [[10, "the-getitem-method"]], "Stacking node features": [[10, "stacking-node-features"]], "Stacking edge features": [[10, "stacking-edge-features"]], "What to return?": [[10, "what-to-return"]], "The DataLoader": [[10, "the-dataloader"]], "Packing graphs": [[10, "packing-graphs"]], "Masks": [[10, "masks"]], "Where to implement the packing": [[10, "where-to-implement-the-packing"]], "Experiment dataset": [[10, "experiment-dataset"]], "Blood Brain Barrier Penetration": [[10, "blood-brain-barrier-penetration"]], "Data splitting": [[10, "data-splitting"]], "Building the datasets": [[10, "building-the-datasets"]], "Questions": [[10, "questions"]], "Optional coding task": [[10, "optional-coding-task"]], "Network and Training": [[10, "network-and-training"]], "The Graph Neural Network": [[10, "the-graph-neural-network"]], "Training the model": [[10, "training-the-model"]], "The training loop": [[10, "the-training-loop"], [11, "the-training-loop"]], "Model configuration": [[10, "model-configuration"]], "Looking at the model predictions": [[10, "looking-at-the-model-predictions"]], "Predictions on the training dataset": [[10, "predictions-on-the-training-dataset"]], "Predictions on the dev set": [[10, "predictions-on-the-dev-set"]], "Predictions on the test set": [[10, "predictions-on-the-test-set"]], "Implementing a Graph Neural Network": [[11, "implementing-a-graph-neural-network"]], "Graph Neural Networks": [[11, "graph-neural-networks"]], "The fundamental challenge: How do we go from a variable sized graph input to a fixed size vector?": [[11, "the-fundamental-challenge-how-do-we-go-from-a-variable-sized-graph-input-to-a-fixed-size-vector"]], "Adjacency list": [[11, "adjacency-list"]], "GNN bottom up": [[11, "gnn-bottom-up"]], "No batches": [[11, "no-batches"]], "Simple example graph": [[11, "simple-example-graph"]], "The embeddings": [[11, "the-embeddings"]], "Embedding dimensionality": [[11, "embedding-dimensionality"]], "Question 1": [[11, "exercise-0"]], "Combining the embedded features with the continuous": [[11, "combining-the-embedded-features-with-the-continuous"]], "Question 2": [[11, "exercise-1"]], "The Graph Layer": [[11, "the-graph-layer"]], "Graph \u201cconvolutions\u201d": [[11, "graph-convolutions"]], "the Aggregation function": [[11, "the-aggregation-function"]], "The message function": [[11, "the-message-function"]], "Task 1": [[11, "exercise-2"]], "Using the adjacency matrix instead of the adjacency list": [[11, "using-the-adjacency-matrix-instead-of-the-adjacency-list"]], "Isn\u2019t this a terribly innefficient way of aggregating?": [[11, "isn-t-this-a-terribly-innefficient-way-of-aggregating"]], "Task 2": [[11, "exercise-3"]], "Task 3": [[11, "exercise-4"]], "Question 3": [[11, "exercise-5"]], "Edge features with adjacency matrices": [[11, "edge-features-with-adjacency-matrices"]], "Taking the step to mini-batches": [[11, "taking-the-step-to-mini-batches"]], "The collate function": [[11, "the-collate-function"]], "Embedder and FeatureCombiner": [[11, "embedder-and-featurecombiner"]], "Batch Graph Layer": [[11, "batch-graph-layer"]], "Question 4": [[11, "exercise-6"]], "Task 4": [[11, "exercise-7"]], "Graph Encoder": [[11, "graph-encoder"]], "Task 5": [[11, "exercise-8"]], "Putting it togheter": [[11, "putting-it-togheter"]], "The dataset": [[11, "the-dataset"]], "Task 6": [[11, "task-6"]], "Task 7 (optional)": [[11, "task-7-optional"]], "In the graph layer": [[11, "in-the-graph-layer"]], "In the encoder": [[11, "in-the-encoder"]], "Session 3 summary": [[11, "session-3-summary"]], "Code from previous notebooks": [[12, "code-from-previous-notebooks"]], "Training step": [[12, "training-step"]], "From GNNs to Transformers": [[12, "from-gnns-to-transformers"]], "Dynamically computed \u201cadjacency matrix\u201d": [[12, "dynamically-computed-adjacency-matrix"]], "The downside": [[12, "the-downside"]], "Implementing a Transformer": [[12, "implementing-a-transformer"]], "Adding the graph structure to Transformers": [[12, "adding-the-graph-structure-to-transformers"]], "Edge features in the attention": [[12, "edge-features-in-the-attention"]], "Edge features in the transformations": [[12, "edge-features-in-the-transformations"]], "Pairwise features": [[12, "pairwise-features"]], "Representing the path information": [[12, "representing-the-path-information"]], "Slow training": [[12, "slow-training"]], "A note on efficiency": [[12, "a-note-on-efficiency"]], "Learning outcomes": [[12, "learning-outcomes"]], "Important concepts": [[12, "important-concepts"]], "What about this multi-head attention?": [[12, "what-about-this-multi-head-attention"]], "What is multi-head self-attention?": [[12, "what-is-multi-head-self-attention"]], "Notebooks and Colab": [[13, "notebooks-and-colab"]], "Quick Reference": [[15, "quick-reference"]]}, "indexentries": {}})